---
title: "OSS License Comprehension Study"
output: html_notebook
---

# Read data

```{r}
library(dplyr)
userdata <- read.csv("OSSStudy6.csv", header=T)
userdata
```

# Eye Fixation data Clustering (MEL + LEL)

```{r,}
df <- scale(select(userdata, matches('melfix|lelfix|switches'), -matches('task'), -matches('melm|lelm')))
colnames(df)
hc <- hclust(dist(df))
plot(hc)
groups <- cutree(hc,k =3)
groups <- cbind(userdata$ID, groups)
print(g1 <- groups[groups[,2] == 1,1])
print(g2 <- groups[groups[,2] == 2,1])
h <- heatmap(df, distfun = dist, hclustfun = hclust, scale="none")
```
# Eye Fixation data Clustering (MEL only)

* Same groups as comined data

```{r,}
df <- scale(select(userdata, matches('melfix|melswitches'), -matches('task')))
colnames(df)
hc <- hclust(dist(df))
groups <- cutree(hc,k =2)
groups <- cbind(userdata$ID, groups)
print(g1 <- groups[groups[,2] == 1,1])
print(g2 <- groups[groups[,2] == 2,1])
h <- heatmap(df, distfun = dist, hclustfun = hclust, scale="none")
```
# Eye Fixation data Clustering (LEL only)

```{r,}
df <- scale(select(userdata, matches('lelfix|lelswitches'), -matches('task')))
colnames(df)
hc <- hclust(dist(df))
groups <- cutree(hc,k =2)
groups <- cbind(userdata$ID, groups)
print(g1 <- groups[groups[,2] == 1,1])
print(g2 <- groups[groups[,2] == 2,1])
h <- heatmap(df, distfun = dist, hclustfun = hclust, scale="none")
```
# Mouse data Clustering (Mouse Data)

```{r,}
df <- scale(select(userdata, matches('mfixdur|mousecnt'), -matches('mel|lel|task')))
colnames(df)
hc <- hclust(dist(df))
groups <- cutree(hc,k =2)
groups <- cbind(userdata$ID, groups)
print(g1 <- groups[groups[,2] == 1,1])
print(g2 <- groups[groups[,2] == 2,1])
h <- heatmap(df, distfun = dist, hclustfun = hclust, scale="none")
```
# Mouse data Clustering (MEL Mouse Data)

```{r,}
df <- scale(select(userdata, matches('melmouse|melm'), -matches('task')))
colnames(df)
hc <- hclust(dist(df))
groups <- cutree(hc,k =3)
groups <- cbind(userdata$ID, groups)
print(g1 <- groups[groups[,2] == 1,1])
print(g2 <- groups[groups[,2] == 2,1])
h <- heatmap(df, distfun = dist, hclustfun = hclust, scale="none")
```

# Mouse data Clustering (LEL Mouse Data)

```{r,}
df <- scale(select(userdata, matches('lelmouse|lelm'), -matches('task')))
colnames(df)
hc <- hclust(dist(df))
groups <- cutree(hc,k =3)
groups <- cbind(userdata$ID, groups)
print(g1 <- groups[groups[,2] == 1,1])
print(g2 <- groups[groups[,2] == 2,1])
print(g3 <- groups[groups[,2] == 3,1])
h <- heatmap(df, distfun = dist, hclustfun = hclust, scale="none")
```

# SUS clustering

```{r,}
df <- scale(select(userdata, SUS, num_range('SUS', 1:10)))
colnames(df)
hc <- hclust(dist(df))
groups <- cutree(hc,k =2)
groups <- cbind(userdata$ID, groups)
print(g1 <- groups[groups[,2] == 1,1])
print(g2 <- groups[groups[,2] == 2,1])
h <- heatmap(df, distfun = dist, hclustfun = hclust, scale="none")
```
# SUS clustering (Learnability 4,10 only)

```{r,}
df <- scale(select(userdata, SUS4, SUS10))
colnames(df)
hc <- hclust(dist(df))
groups <- cutree(hc,k =2)
groups <- cbind(userdata$ID, groups)
print(g1 <- groups[groups[,2] == 1,1])
print(g2 <- groups[groups[,2] == 2,1])
h <- heatmap(df, distfun = dist, hclustfun = hclust, scale="none")
```

# SUS clustering (Usability only)

```{r,}
df <- scale(select(userdata, num_range('SUS', 1:10), -SUS4, -SUS10))
colnames(df)
hc <- hclust(dist(df))
groups <- cutree(hc,k =2)
groups <- cbind(userdata$ID, groups)
print(g1 <- groups[groups[,2] == 1,1])
print(g2 <- groups[groups[,2] == 2,1])
h <- heatmap(df, distfun = dist, hclustfun = hclust, scale="none")
```
# All Tracking Data

```{r}
df <- scale(select(userdata, matches('melfix|lelfix|switches'), matches('melm'), matches('lelm'), matches('task'))) # -matches('hierarchy|hierachy')
colnames(df)
hc <- hclust(dist(df))
hc2 <- hclust(dist(t(df)))
par(mar=c(3,1,1,10))
plot(as.dendrogram(hc2),horiz=T)
plot(hc)
groups <- cutree(hc,k =2)
groups <- cbind(userdata$ID, groups)
print(g1 <- groups[groups[,2] == 1,1])
print(g2 <- groups[groups[,2] == 2,1])
print(g3 <- groups[groups[,2] == 3,1])
h <- heatmap(df, distfun = dist, hclustfun = hclust, scale="none")
```

# Significant test between groups

```{r}

# Add computed columns to userdata

userdata <- userdata %>%
              mutate(learnability = SUS4 + SUS10,
                     usability = SUS1 + SUS2 + SUS3 + SUS5 + SUS6 + SUS7 + SUS8 + SUS9,
                     score = (melacc1 * ifelse(melconf1 == " h", 3, ifelse( melconf1 == " l", 2, 1)) +
                                melacc2 * ifelse(melconf2 == " h", 3, ifelse( melconf2 == " l", 2, 1)) +
                                lelacc1 * ifelse(lelconf1 == " h", 3, ifelse( lelconf1 == " l", 2, 1)) +
                                lelacc2 * ifelse(lelconf2 == " h", 3, ifelse( lelconf2 == " l", 2, 1)))/12*100,
                     conf = (ifelse(melconf1 == " h", 3, ifelse( melconf1 == " l", 2, 1)) +
                                ifelse(melconf2 == " h", 3, ifelse( melconf2 == " l", 2, 1)) +
                                ifelse(lelconf1 == " h", 3, ifelse( lelconf1 == " l", 2, 1)) +
                                ifelse(lelconf2 == " h", 3, ifelse( lelconf2 == " l", 2, 1)))/12*100,
                     rawscore = melacc1+melacc2+lelacc1+lelacc2)
group <- as.factor(groups[,2])
userdata <- cbind(group, userdata)
#userdata <- userdata[(ID != 3 & ID != 6),] 
userdata
```


```{r}

# g1 <- c(6, 7, 8)
# g2 <- c(1, 9, 3, 4, 5, 2, 10)

group1 <- userdata %>%
  filter (ID %in% g1)

group2 <- userdata %>%
  filter (ID %in% g2)

# Test for score difference between two groups
boxplot(group1$score, group2$score)
shapiro.test(userdata$score)
plot(density(userdata$score))
t.test(group1$score, group2$score)
wilcox.test(group1$score, group2$score)
```

```{r}

# Test for eye fixation count difference between two groups
boxplot(rowSums(select(group1, matches('melfixcnt|lelfixcnt'), -matches('task'))),
        rowSums(select(group2, matches('melfixcnt|lelfixcnt'), -matches('task'))))

t.test(rowSums(select(group1, matches('melfixcnt|lelfixcnt'), -matches('task'))),
        rowSums(select(group2, matches('melfixcnt|lelfixcnt'), -matches('task'))))

wilcox.test(rowSums(select(group1, matches('melfixcnt|lelfixcnt'), -matches('task'))),
        rowSums(select(group2, matches('melfixcnt|lelfixcnt'), -matches('task'))))


# Test for eye fixation duration difference between two groups

boxplot(rowSums(select(group1, matches('melfixdur|lelfixdur'), -matches('task'))),
        rowSums(select(group2, matches('melfixdur|lelfixdur'), -matches('task'))))

t.test(rowSums(select(group1, matches('melfixdur|lelfixdur'), -matches('task'))),
        rowSums(select(group2, matches('melfixdur|lelfixdur'), -matches('task'))))

wilcox.test(rowSums(select(group1, matches('melfixdur|lelfixdur'), -matches('task'))),
            rowSums(select(group2, matches('melfixdur|lelfixdur'), -matches('task'))))


# Test for SUS difference between two groups
boxplot(group1$SUS, group2$SUS, names = c("Group1", "Group 2"))
t.test(group1$SUS, group2$SUS)
wilcox.test(group1$SUS, group2$SUS)

summary(group1$SUS)
sd(group1$SUS)
summary(group2$SUS)
sd(group2$SUS)

# Test for SUS Learnability subscale difference between two groups
boxplot(group1$learnability, group2$learnability, names = c("Group1", "Group 2"))
t.test(group1$learnability, group2$learnability)
wilcox.test(group1$learnability, group2$learnability)

# Test for SUS Usability subscale difference between two groups
boxplot(group1$usability, group2$usability, names = c("Group1", "Group 2"))
t.test(group1$usability, group2$usability)
wilcox.test(group1$usability, group2$usability)

# Test for mouse fixation count difference between two groups

boxplot(rowSums(select(group1, matches('mousecnt'), -matches('task'))),
        rowSums(select(group2, matches('mousecnt'), -matches('task'))))

t.test(rowSums(select(group1, matches('mousecnt'), -matches('task'))),
        rowSums(select(group2, matches('mousecnt'), -matches('task'))))

wilcox.test(rowSums(select(group1, matches('mousecnt'), -matches('task'))),
        rowSums(select(group2, matches('mousecnt'), -matches('task'))))


# Test for mouse fixation duration difference between two groups

boxplot(rowSums(select(group1, matches('mfixdur'), -matches('task'))),
        rowSums(select(group2, matches('mfixdur'), -matches('task'))))

t.test(rowSums(select(group1, matches('mfixdur'), -matches('task'))),
        rowSums(select(group2, matches('mfixdur'), -matches('task'))))

wilcox.test(rowSums(select(group1, matches('mfixdur'), -matches('task'))),
            rowSums(select(group2, matches('mfixdur'), -matches('task'))))




boxplot(group1$conf, group2$conf)
t.test(group1$conf, group2$conf)
wilcox.test(group1$conf, group2$conf)
```
# Three Group Analysis
```{r}
attach(userdata)
# Test for eye fixation count difference between two groups
boxplot(rowSums(select(userdata, matches('melfixcnt|lelfixcnt'), -matches('task')))~userdata$group)

res.aov <- aov(rowSums(select(userdata, matches('melfixcnt|lelfixcnt'), -matches('task')))~userdata$group)
summary(res.aov)
TukeyHSD(res.aov)

```

```{r}
# Test for eye fixation duration difference between two groups
boxplot(rowSums(select(userdata, matches('melfixdur|lelfixdur'), -matches('task')))~group)
res.aov <- aov(rowSums(select(userdata, matches('melfixdur|lelfixdur'), -matches('task')))~group)
summary(res.aov)
TukeyHSD(res.aov)
```



```{r}
# Test for SUS difference between two groups
boxplot(SUS~group, names = c("Group1", "Group 2", "Group 3"))
res.aov <- aov(SUS~group)
summary(res.aov)
TukeyHSD(res.aov)
```


```{r}
# Test for SUS Learnability subscale difference between two groups
boxplot(learnability~group, names = c("Group1", "Group 2", "Group 3"))
res.aov <- aov(learnability~group)
summary(res.aov)
TukeyHSD(res.aov)
```


```{r}
# Test for SUS Usability subscale difference between two groups
boxplot(usability~group, names = c("Group1", "Group 2", "Group 3"))
res.aov <- aov(usability~group)
summary(res.aov)
TukeyHSD(res.aov)
```

```{r}
# Test for mouse fixation count difference between two groups

boxplot(rowSums(select(userdata, matches('mousecnt'), -matches('task')))~group)
res.aov <- aov(rowSums(select(userdata, matches('mousecnt'), -matches('task')))~group)
summary(res.aov)
TukeyHSD(res.aov)
```
```{r}
# Test for mouse fixation duration difference between two groups

boxplot(rowSums(select(userdata, matches('mfixdur'), -matches('task')))~group)
res.aov <- aov(rowSums(select(userdata, matches('mfixdur'), -matches('task')))~group)
summary(res.aov)
TukeyHSD(res.aov)

```
```{r}
# Test for score difference between two groups

boxplot(userdata$score~userdata$group)
res.aov <- aov(score~group)
summary(res.aov)
TukeyHSD(res.aov)

summary(userdata$score[userdata$group == 1])
summary(userdata$score[userdata$group == 2])
summary(userdata$score[userdata$group == 3])

sd(userdata$score[userdata$group == 1])
sd(userdata$score[userdata$group == 2])
sd(userdata$score[userdata$group == 3])

t.test(userdata$score[group==1 | group==2], userdata$score[group==3])
wilcox.test(userdata$score[group==1 | group==2], userdata$score[group==3])

```

```{r}
boxplot(conf~group)
res.aov <- aov(conf~group)
summary(res.aov)
TukeyHSD(res.aov)

summary(userdata$conf[userdata$group == 1])
summary(userdata$conf[userdata$group == 2])
summary(userdata$conf[userdata$group == 3])

sd(userdata$conf[userdata$group == 1])
sd(userdata$conf[userdata$group == 2])
sd(userdata$conf[userdata$group == 3])
```
